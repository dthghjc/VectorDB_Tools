# VectorDB_Tools é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„

## é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªå›´ç»•æ•°æ®å¤„ç†å·¥ä½œæµçš„ä»»åŠ¡ç®¡ç†å¹³å°ï¼Œä»åŸå§‹æ•°æ®åˆ° Milvus å¯ç”¨æ•°æ®çš„å®Œæ•´æµæ°´çº¿ã€‚

## å®é™…é¡¹ç›®ç»“æ„

```
VectorDB_Tools/
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ backend/                # åç«¯æœåŠ¡ (FastAPI + SQLAlchemy)
â”‚   â”œâ”€â”€ alembic/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”œâ”€â”€ alembic.ini        # Alembic é…ç½®
â”‚   â”œâ”€â”€ app/               # æ ¸å¿ƒåº”ç”¨ä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/           # HTTP æ¥å£å±‚
â”‚   â”‚   â”‚   â””â”€â”€ v1/        # API ç‰ˆæœ¬æ§åˆ¶
â”‚   â”‚   â”‚       â”œâ”€â”€ router.py          # ä¸»è·¯ç”±èšåˆå™¨
â”‚   â”‚   â”‚       â””â”€â”€ endpoints/         # å…·ä½“ç«¯ç‚¹å®ç°
â”‚   â”‚   â”‚           â”œâ”€â”€ auth/          # è®¤è¯ç›¸å…³ç«¯ç‚¹
â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ router.py  # âœ… åªå¤„ç†ï¼šå‚æ•°æå–ã€ä¾èµ–æ³¨å…¥ã€HTTPçŠ¶æ€ç 
â”‚   â”‚   â”‚           â”‚   â””â”€â”€ dependencies.py # è®¤è¯ä¾èµ–
â”‚   â”‚   â”‚           â”œâ”€â”€ keys/          # API Key ç®¡ç†ç«¯ç‚¹
â”‚   â”‚   â”‚           â”‚   â””â”€â”€ router.py  # âœ… ä¸åŒ…å«ï¼šä¸šåŠ¡é€»è¾‘ã€å¤–éƒ¨APIè°ƒç”¨
â”‚   â”‚   â”‚           â””â”€â”€ embeddings/    # åµŒå…¥å‘é‡ç«¯ç‚¹
â”‚   â”‚   â”‚               â””â”€â”€ router.py  # âœ… èŒè´£ï¼šRESTful åè®®é€‚é…
â”‚   â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py  # é¡¹ç›®é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ crypto.py  # åŠ å¯†ç³»ç»Ÿ (RSA + AES)
â”‚   â”‚   â”‚   â”œâ”€â”€ db.py      # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â””â”€â”€ security.py # è®¤è¯å®‰å…¨
â”‚   â”‚   â”œâ”€â”€ crud/          # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ api_key.py # âœ… å¤„ç†ï¼šçº¯æ•°æ®åº“æ“ä½œã€æŸ¥è¯¢ä¼˜åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py    # âœ… å¤„ç†ï¼šæ•°æ®æƒé™è¿‡æ»¤
â”‚   â”‚   â”‚   â””â”€â”€ base.py    # âœ… èŒè´£ï¼šCRUD åŸºç¡€æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ llm_clients/   # å¤–éƒ¨æœåŠ¡é€‚é…å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py    # âœ… èŒè´£ï¼šç»Ÿä¸€çš„å¤–éƒ¨æœåŠ¡æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ factory.py # âœ… å¤„ç†ï¼šå®¢æˆ·ç«¯åˆ›å»ºã€æä¾›å•†é€‚é…
â”‚   â”‚   â”‚   â”œâ”€â”€ openai_client.py  # âœ… å¤„ç†ï¼šåè®®è½¬æ¢ã€è¿æ¥ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ ollama_client.py  # Ollama å®¢æˆ·ç«¯é€‚é…
â”‚   â”‚   â”œâ”€â”€ models/        # SQLAlchemy æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py    # åŸºç¡€æ¨¡å‹ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py    # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ api_key.py # API Key æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ connection.py      # Milvus è¿æ¥æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ upload_history.py  # æ–‡ä»¶ä¸Šä¼ å†å²
â”‚   â”‚   â”œâ”€â”€ schemas/       # Pydantic æ•°æ®éªŒè¯
â”‚   â”‚   â”‚   â”œâ”€â”€ api_key.py # API Key éªŒè¯æ¨¡å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ crypto.py  # åŠ å¯†ç›¸å…³æ¨¡å¼
â”‚   â”‚   â”‚   â””â”€â”€ user.py    # ç”¨æˆ·éªŒè¯æ¨¡å¼
â”‚   â”‚   â””â”€â”€ services/      # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚       â”œâ”€â”€ api_key_service.py  # âœ… å¤„ç†ï¼šAPI Key ç®¡ç†ä¸šåŠ¡æµç¨‹
â”‚   â”‚       â”œâ”€â”€ embedding_service.py # âœ… å¤„ç†ï¼šå‘é‡åŒ–ä¸šåŠ¡é€»è¾‘
â”‚   â”‚       â””â”€â”€ milvus_service.py   # âœ… èŒè´£ï¼šå¤æ‚ä¸šåŠ¡è§„åˆ™ã€å·¥ä½œæµåè°ƒ
â”‚   â”œâ”€â”€ main.py            # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ pyproject.toml     # é¡¹ç›®ä¾èµ– (uv ç®¡ç†)
â”‚   â”œâ”€â”€ README.md          # åç«¯æ–‡æ¡£
â”‚   â”œâ”€â”€ test/              # æµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ uv.lock            # ä¾èµ–é”å®šæ–‡ä»¶
â””â”€â”€ frontend/              # å‰ç«¯åº”ç”¨ (React + Vite)
    â”œâ”€â”€ components.json    # shadcn/ui é…ç½®
    â”œâ”€â”€ eslint.config.js   # ESLint é…ç½®
    â”œâ”€â”€ index.html         # HTML å…¥å£
    â”œâ”€â”€ package.json       # å‰ç«¯ä¾èµ– (pnpm ç®¡ç†)
    â”œâ”€â”€ pnpm-lock.yaml     # ä¾èµ–é”å®šæ–‡ä»¶
    â”œâ”€â”€ public/            # é™æ€èµ„æº
    â”œâ”€â”€ README.md          # å‰ç«¯æ–‡æ¡£
    â”œâ”€â”€ src/               # æºä»£ç 
    â”‚   â”œâ”€â”€ api/           # API è°ƒç”¨å°è£…
    â”‚   â”‚   â””â”€â”€ connection.ts
    â”‚   â”œâ”€â”€ App.css
    â”‚   â”œâ”€â”€ App.tsx        # æ ¹ç»„ä»¶
    â”‚   â”œâ”€â”€ assets/        # é™æ€èµ„æº
    â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ common/    # é€šç”¨ç»„ä»¶
    â”‚   â”‚   â”‚   â””â”€â”€ LanguageSwitcher.tsx
    â”‚   â”‚   â”œâ”€â”€ features/  # åŠŸèƒ½ç»„ä»¶
    â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # è®¤è¯ç›¸å…³
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ login-form.tsx
    â”‚   â”‚   â”‚   â”œâ”€â”€ connection/    # è¿æ¥ç®¡ç†
    â”‚   â”‚   â”‚   â”œâ”€â”€ dataUpload/    # æ•°æ®ä¸Šä¼ 
    â”‚   â”‚   â”‚   â”œâ”€â”€ profile/       # ç”¨æˆ·é…ç½®
    â”‚   â”‚   â”‚   â””â”€â”€ vectorSearch/  # å‘é‡æœç´¢
    â”‚   â”‚   â”œâ”€â”€ layout/    # å¸ƒå±€ç»„ä»¶
    â”‚   â”‚   â”‚   â”œâ”€â”€ AppLayout.tsx
    â”‚   â”‚   â”‚   â””â”€â”€ AuthLayout.tsx
    â”‚   â”‚   â””â”€â”€ ui/        # shadcn/ui åŸºç¡€ç»„ä»¶
    â”‚   â”‚       â”œâ”€â”€ button.tsx
    â”‚   â”‚       â”œâ”€â”€ card.tsx
    â”‚   â”‚       â”œâ”€â”€ input.tsx
    â”‚   â”‚       â””â”€â”€ label.tsx
    â”‚   â”œâ”€â”€ hooks/         # è‡ªå®šä¹‰ Hooks
    â”‚   â”œâ”€â”€ i18n.ts        # å›½é™…åŒ–é…ç½®
    â”‚   â”œâ”€â”€ index.css      # å…¨å±€æ ·å¼
    â”‚   â”œâ”€â”€ lib/           # å·¥å…·åº“
    â”‚   â”‚   â”œâ”€â”€ axios.ts   # HTTP å®¢æˆ·ç«¯
    â”‚   â”‚   â””â”€â”€ utils.ts   # å·¥å…·å‡½æ•°
    â”‚   â”œâ”€â”€ main.tsx       # React å…¥å£
    â”‚   â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ auth/      # è®¤è¯é¡µé¢
    â”‚   â”‚   â”œâ”€â”€ home/      # é¦–é¡µ
    â”‚   â”‚   â””â”€â”€ NotFoundPage/  # 404é¡µé¢
    â”‚   â”œâ”€â”€ router/        # è·¯ç”±é…ç½®
    â”‚   â”œâ”€â”€ styles/        # æ ·å¼æ–‡ä»¶
    â”‚   â”œâ”€â”€ types/         # TypeScript ç±»å‹å®šä¹‰
    â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
    â”‚   â””â”€â”€ vite-env.d.ts  # Vite ç±»å‹å£°æ˜
    â”œâ”€â”€ tsconfig.app.json  # TypeScript åº”ç”¨é…ç½®
    â”œâ”€â”€ tsconfig.json      # TypeScript ä¸»é…ç½®
    â”œâ”€â”€ tsconfig.node.json # TypeScript Nodeé…ç½®
    â””â”€â”€ vite.config.ts     # Vite æ„å»ºé…ç½®
```

## æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: FastAPI
- **ORM**: SQLAlchemy
- **åŒ…ç®¡ç†**: uv (æ›¿ä»£ pip/poetry)
- **æ•°æ®åº“è¿ç§»**: Alembic
- **å‘é‡æ•°æ®åº“**: Milvus

### å‰ç«¯
- **æ¡†æ¶**: React 19 + Vite
- **åŒ…ç®¡ç†**: pnpm
- **UIæ¡†æ¶**: shadcn/ui + TailwindCSS v4
- **ç±»å‹æ£€æŸ¥**: TypeScript
- **HTTPå®¢æˆ·ç«¯**: Axios
- **å›½é™…åŒ–**: i18next

## å¼€å‘çŠ¶æ€

### âœ… å·²å®ç°
- **é¡¹ç›®æ¶æ„**ï¼šå®Œæ•´çš„åˆ†å±‚æ¶æ„è®¾è®¡ï¼ˆAPI + Service + CRUD + Clientï¼‰
- **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ**ï¼šå®Œæ•´çš„ç™»å½•æ³¨å†Œã€JWT è®¤è¯ã€æƒé™ç®¡ç†
- **API Key ç®¡ç†**ï¼šåŠ å¯†å­˜å‚¨ã€å¤šæä¾›å•†æ”¯æŒã€éªŒè¯æµ‹è¯•
- **åµŒå…¥æœåŠ¡æ¶æ„**ï¼šç»Ÿä¸€çš„å‘é‡åŒ–æ¥å£ã€LLM å®¢æˆ·ç«¯å·¥å‚æ¨¡å¼
- **å®‰å…¨ç³»ç»Ÿ**ï¼šRSA + AES åŒé‡åŠ å¯†ã€å¯†é’¥ç®¡ç†
- **å‰ç«¯ç»„ä»¶åº“**ï¼šshadcn/ui + TailwindCSS v4 é›†æˆ
- **æ•°æ®åº“æ¨¡å‹**ï¼šUserã€ApiKey ç­‰æ ¸å¿ƒæ¨¡å‹å®Œå–„

### ğŸš§ å¼€å‘ä¸­
- **åµŒå…¥å‘é‡ API**ï¼šæ–‡æœ¬å‘é‡åŒ–æ¥å£å®ç°
- **æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½**ï¼šæ”¯æŒå¤šç§æ ¼å¼çš„æ•°æ®ä¸Šä¼ 
- **Milvus é›†æˆ**ï¼šå‘é‡æ•°æ®åº“è¿æ¥å’Œæ“ä½œ

### ğŸ“‹ å¾…å®ç°
- **Schema ç®¡ç†å™¨**ï¼šMilvus Collection æ¨¡æ¿ç®¡ç†
- **æ•°æ®å¯¼å…¥æµæ°´çº¿**ï¼šä¸Šä¼  â†’ å‘é‡åŒ– â†’ åŠ è½½çš„å®Œæ•´å·¥ä½œæµ
- **ä»»åŠ¡ä¸­å¿ƒä»ªè¡¨ç›˜**ï¼šåå°ä»»åŠ¡çŠ¶æ€ç›‘æ§å’Œç®¡ç†
- **æ£€ç´¢ä¸è¯„ä¼°ä¸­å¿ƒ**ï¼šå‘é‡æ£€ç´¢æ•ˆæœæµ‹è¯•å’Œè¯„ä¼°
- **åå°ä»»åŠ¡é˜Ÿåˆ—**ï¼šCelery + Redis å¼‚æ­¥ä»»åŠ¡å¤„ç†

### ğŸ—ï¸ æ¶æ„ä¼˜åŠ¿
- **Linus å¼è®¾è®¡**ï¼šç®€æ´æ•°æ®ç»“æ„ã€æ¶ˆé™¤ç‰¹æ®Šæƒ…å†µã€å®ç”¨ä¸»ä¹‰å¯¼å‘
- **æ¸…æ™°åˆ†å±‚**ï¼šAPI å±‚åªå¤„ç† HTTPï¼ŒService å±‚å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ŒCRUD å±‚å¤„ç†æ•°æ®
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**ï¼šé¿å…é‡å¤ä»£ç ï¼Œæä¾›ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ
- **æ‰©å±•æ€§å¼º**ï¼šæ–°å¢ LLM æä¾›å•†åªéœ€å®ç°å®¢æˆ·ç«¯æ¥å£

## ğŸ¯ åˆ†å±‚æ¶æ„æœ€ä½³å®è·µ

### ğŸ“‹ å„å±‚èŒè´£å®šä¹‰

#### **1. API å±‚ (`/api/v1/endpoints/`)**
```python
# âœ… èŒè´£ï¼šHTTP åè®®å¤„ç†
@router.post("/{key_id}/test")
async def test_api_key(key_id: UUID, current_user: User, db: Session):
    result = api_key_service.validate_api_key(key_id, current_user.id, db)
    return format_response(result)

# âŒ ç¦æ­¢ï¼šä¸šåŠ¡é€»è¾‘ã€å¤–éƒ¨ API è°ƒç”¨ã€å¤æ‚è®¡ç®—
```

#### **2. Service å±‚ (`/services/`)**
```python
# âœ… èŒè´£ï¼šä¸šåŠ¡é€»è¾‘åè°ƒ
def validate_api_key(self, key_id, user_id, db):
    api_key = self._get_validated_api_key(db, key_id, user_id)  # CRUD è°ƒç”¨
    client = self._get_llm_client(db, api_key)                 # Client è°ƒç”¨
    return client.validate_api_key()                           # ä¸šåŠ¡æµç¨‹

# âŒ ç¦æ­¢ï¼šHTTP å¤„ç†ã€ç›´æ¥ SQL æ“ä½œ
```

#### **3. CRUD å±‚ (`/crud/`)**
```python
# âœ… èŒè´£ï¼šæ•°æ®åº“æ“ä½œ
def get(self, db: Session, id: UUID, user_id: UUID) -> Optional[ApiKey]:
    return db.query(ApiKey).filter(
        and_(ApiKey.id == id, ApiKey.user_id == user_id)
    ).first()

# âŒ ç¦æ­¢ï¼šä¸šåŠ¡é€»è¾‘ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨
```

#### **4. Client å±‚ (`/llm_clients/`)**
```python
# âœ… èŒè´£ï¼šå¤–éƒ¨æœåŠ¡é€‚é…
def validate_api_key(self) -> Tuple[bool, str]:
    client = OpenAI(api_key=self.api_key, base_url=self.base_url)
    client.models.list()  # ç»Ÿä¸€çš„éªŒè¯æ¥å£
    return True, "éªŒè¯æˆåŠŸ"

# âŒ ç¦æ­¢ï¼šæ•°æ®åº“æ“ä½œã€ä¸šåŠ¡é€»è¾‘
```

### ğŸ”„ æ•°æ®æµå‘å›¾
```
HTTP Request â†’ API å±‚ â†’ Service å±‚ â†’ CRUD å±‚ â†’ Database
                â†“         â†“           â†“
           å‚æ•°æå–    ä¸šåŠ¡é€»è¾‘    æ•°æ®æ“ä½œ
                â†“         â†“           â†“  
           HTTP Response â† ç»“æœå¤„ç† â† Client å±‚ â† External API
```